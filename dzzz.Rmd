---
title: "dz2"
author: "Sergei Vigant"
date: '28 сентября 2016 г '
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Пункт 1.
```{r American_Express}
fit<-lm(Costs ~ Miles, data=American_Express)
summary(fit)
```




С помощью данной функции была построена регрессия по данным переменным.Уравнение регрессии выглядит следующим образом:
Costs=274.85+1.255*Miles
По данному уравнению можно сделать следующие выводы:В любом случае даже,если не будет пройдено ни одной мили,стоимость путешествия будет равна 274.85 доллара.Из столбца Pr(>|t|) ясно,что коэффициент регрессии статистически значимо отличается от нуля(p<0.001) и означает,что на каждую пройденную миль путешествия ожидается увеличение стоимости путешествия на 1.255 доллара.
Также можно заметить,что модель объясняет 96,52 % дисперсии значений стоимости путешествия.(Это показывает R^2).

## Пункт 2.

```{r fit}
confint(fit)
```

C помощью данной функции были построены доверительные интервалы по каждой из переменных.Так как коэффициент регрессии лежит внутри полученного доверительного интервала, то можно сделать вывод о том,что он не значим.


#### Пункт 4

```{r}
fitted(fit)
residuals(fit)
```

Можно заметить,что фактические и предсказанные данные по переменной стоимости путешествия расположены довольно далеко друг от друга.Остатки-это разность между предсказанными и реальными значениями.


##### Пункт 5

```{r}
scatterplot(American_Express$Miles,American_Express$Costs)
```

На основе полученного графика можно сделать вывод о том,что эмпирическая и теоретическая линия регрессии расположены довольно близко,нет больших отклонений их друг от друга ни в одном интервале.Значит,наша модель объясняет данную зависимость с большим процентом точности.


##### Пункт 7

```{r}
new.costs<-data.frame(Miles=c(6000))
predict(fit,newdata=new.costs)
```

Менеджер предсказал расходы в размере 7806.852 доллара.

###### Пункт 8 

```{r}
new.cost<-data.frame(Miles=c(5550))
predict(fit,newdata=new.cost,interval="prediction")
```

В данном пункте был построен интервальный прогноз,который показывает,Что для человека который провёл в пути 5550 миль,стоимость будет в среднем равна 7241.952 доллара.Ну а вообще,будет располагаться в интервале от 6527.792 доллара до 7956.113 доллара.







